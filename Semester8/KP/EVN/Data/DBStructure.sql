/*=================================================================*/
  CREATE DATABASE "C:\Projects\EVN\Data\EVN.gdb"
           user "SYSDBA"     
         password "masterkey"  
         page_size=4096;
/*=================================================================*/
CREATE TABLE CUSTOMERS_TBL
(
ID INTEGER NOT NULL,
EGN  VARCHAR(10),
NAME VARCHAR(12),
FAM  VARCHAR(15),
ADDRESS VARCHAR(33),
PRIMARY KEY(ID)
);

CREATE TABLE ACCOUNTTYPES_TBL
(
ID INTEGER NOT NULL,
ACCOUNTTYPE VARCHAR(12),
PRIMARY KEY(ID)
);

CREATE TABLE ACCOUNTS_TBL
(
ID INTEGER NOT NULL,
CID INTEGER,
ATID INTEGER,
ACCOUNT_NO VARCHAR(12),
DATA INTEGER,
PAYMENT NUMERIC(14,2),
PRIMARY KEY(ID),
FOREIGN KEY(CID) REFERENCES CUSTOMERS_TBL(ID),
FOREIGN KEY(ATID) REFERENCES ACCOUNTTYPES_TBL(ID)
);

/* ------------------------------------ */

CREATE GENERATOR CUSTOMERSTBL_IDGEN;
SET GENERATOR CUSTOMERSTBL_IDGEN TO 0;

CREATE GENERATOR ACCOUNTSTBL_IDGEN;
SET GENERATOR ACCOUNTSTBL_IDGEN TO 0;


SET TERM ^ ;

CREATE PROCEDURE CUSTOMERSTBL_IDSP
RETURNS(ID INTEGER)
AS
BEGIN
ID = GEN_ID(CUSTOMERSTBL_IDGEN, 1);
END^

CREATE PROCEDURE ACCOUNTSTBL_IDSP
RETURNS(ID INTEGER)
AS
BEGIN
ID = GEN_ID(ACCOUNTSTBL_IDGEN, 1);
END^

SET TERM ; ^

/* ------------------------------------ */

CREATE INDEX CustomersTblNameNDX ON CUSTOMERS_TBL(NAME);
CREATE INDEX CustomersTblFamNDX ON CUSTOMERS_TBL(FAM);

/* ------------------------------------ */

SELECT C.EGN, C.NAME, C.FAM, A.DATA, A.PAYMENT, ACT.ACCOUNTTYPE
FROM CUSTOMERS_TBL C, ACCOUNTS_TBL A, ACCOUNTTYPES_TBL ACT
WHERE C.EGN = :PEGN AND C.ID = A.CID AND A.ATID = ACT.ID


